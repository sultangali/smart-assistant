# Скрипты для управления контентом

## Миграция многоязычных описаний инструментов

### Описание
Скрипт `migrateToolDescriptions.js` автоматически добавляет поддержку многоязычных описаний к существующим инструментам в базе данных.

### Использование
```bash
node server/scripts/migrateToolDescriptions.js
```

### Что делает скрипт:
1. **Подключается к БД** и получает все существующие инструменты
2. **Проверяет наличие** поля `descriptions` у каждого инструмента
3. **Копирует описание** из поля `description` во все языковые версии (ru, en, kk)
4. **Сохраняет изменения** и выводит отчет о выполненной работе
5. **Сохраняет совместимость** с существующим полем `description`

### Когда использовать:
- После обновления до версии 2.0.0
- При добавлении поддержки многоязычных описаний
- Для инициализации поля `descriptions` у существующих инструментов

### Результат:
- ✅ Добавлено поле `descriptions` ко всем инструментам
- ✅ Описания скопированы на все языки
- ✅ Сохранена обратная совместимость
- ✅ Готовность к редактированию переводов через админ-панель

## Извлечение контента из i18next файлов

### Описание
Скрипт `extractContent.js` автоматически извлекает все тексты из файлов переводов i18next и создает записи в базе данных для управления контентом через админ панель.

### Использование
```bash
npm run extract-content
```

### Что делает скрипт:
1. **Читает файлы переводов** из `client/src/i18n/locales/`
2. **Парсит структуру** переводов по секциям (hero, about, filter, feedback, contact, nav, admin, common)
3. **Определяет типы контента** (title, subtitle, description, placeholder, button, label, value, text)
4. **Создает записи в БД** с русскими и английскими переводами
5. **Организует контент** по компонентам и категориям

### Результат:
- ✅ **183 элемента контента** извлечено из i18next файлов
- ✅ **8 секций** обработано (admin, about, feedback, contact, nav, filter, common, hero)
- ✅ **Русские и английские переводы** сохранены в БД
- ✅ **Метаданные** для организации контента добавлены

## Тестирование API переводов

### Описание
Скрипт `testI18nAPI.js` тестирует API эндпоинты для получения переводов с сервера.

### Использование
```bash
npm run test-i18n
```

### Что тестирует:
1. **GET /api/i18n/languages** - список поддерживаемых языков
2. **GET /api/i18n/ru** - все русские переводы
3. **GET /api/i18n/en** - все английские переводы
4. **GET /api/i18n/ru/hero** - переводы конкретной секции
5. **Структуру данных** и корректность переводов

## API Эндпоинты

### Получение переводов
- `GET /api/i18n/languages` - поддерживаемые языки
- `GET /api/i18n/:lang` - все переводы для языка
- `GET /api/i18n/:lang/:section` - переводы секции для языка

### Управление контентом (только для админов)
- `GET /api/content` - весь контент
- `POST /api/content` - создать контент
- `PUT /api/content/:id` - обновить контент
- `DELETE /api/content/:id` - удалить контент
- `PUT /api/content/:id/translation/:lang` - обновить перевод

## Структура данных

### Модель Content
```javascript
{
  key: "landing.hero.title",
  section: "hero",
  type: "title",
  isVisible: true,
  order: 0,
  metadata: {
    component: "HeroSection",
    field: "title",
    category: "landing"
  },
  translations: {
    ru: { title: "Откройте для себя мир ИИ-инструментов" },
    en: { title: "Discover the world of AI tools" }
  }
}
```

### Секции
- **hero** - главная секция
- **about** - о нас
- **filter** - фильтр
- **feedback** - обратная связь
- **contact** - контакты
- **nav** - навигация
- **admin** - админ панель
- **common** - общее

### Типы контента
- **text** - обычный текст
- **title** - заголовок
- **subtitle** - подзаголовок
- **description** - описание
- **placeholder** - плейсхолдер
- **button** - кнопка
- **label** - метка
- **value** - значение

## Интеграция с клиентом

### Загрузка переводов с сервера
```javascript
import { loadTranslationsFromServer } from './utils/i18nLoader';

// Загрузить все переводы
const translations = await loadTranslationsFromServer('ru');

// Загрузить переводы секции
const heroTranslations = await loadTranslationsBySection('ru', 'hero');
```

### Использование в i18next
```javascript
import i18n from 'i18next';
import { loadTranslationsFromServer } from './utils/i18nLoader';

// Инициализация с загрузкой с сервера
i18n.init({
  lng: 'ru',
  fallbackLng: 'ru',
  resources: {
    ru: { translation: await loadTranslationsFromServer('ru') },
    en: { translation: await loadTranslationsFromServer('en') }
  }
});
```

## Преимущества системы

1. **Централизованное управление** - весь контент в одном месте
2. **Многоязычность** - поддержка любого количества языков
3. **Версионность** - история изменений контента
4. **Организация** - структурирование по секциям и типам
5. **API доступ** - получение переводов через REST API
6. **Админ панель** - удобное управление через веб-интерфейс
